module.exports=[38452,a=>{a.v({active:"page-module__xGAElW__active",backButton:"page-module__xGAElW__backButton",card:"page-module__xGAElW__card",completed:"page-module__xGAElW__completed",container:"page-module__xGAElW__container",form:"page-module__xGAElW__form",header:"page-module__xGAElW__header",icon:"page-module__xGAElW__icon",iconWrapper:"page-module__xGAElW__iconWrapper",progress:"page-module__xGAElW__progress",progressDot:"page-module__xGAElW__progressDot",progressLabel:"page-module__xGAElW__progressLabel",progressLine:"page-module__xGAElW__progressLine",progressStep:"page-module__xGAElW__progressStep",pulse:"page-module__xGAElW__pulse",resendButton:"page-module__xGAElW__resendButton",resendTimer:"page-module__xGAElW__resendTimer",resendWrapper:"page-module__xGAElW__resendWrapper",stepContent:"page-module__xGAElW__stepContent",subtitle:"page-module__xGAElW__subtitle",successIcon:"page-module__xGAElW__successIcon",title:"page-module__xGAElW__title"})},936,a=>{"use strict";var b=a.i(14793),c=a.i(29507);a.i(46121);var d=a.i(83556),e=a.i(62870),f=a.i(15188),g=a.i(16080);a.i(22142);var h=a.i(72395);a.i(59096);var i=a.i(82728);a.i(10434);var j=a.i(42172),k=a.i(38452);let l="mobile",m="aadhar",n="confirm",o="pending";function p(){let{t:a}=(0,d.useTranslation)(),p=(0,e.useDispatch)(),q=(0,f.useRouter)(),{isLoading:r,mobileNumber:s,error:t,isAuthenticated:u,user:v}=(0,e.useSelector)(a=>a.auth),[w,x]=(0,c.useState)(l),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(0),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)({name:"",dateOfBirth:"",address:""}),[O,P]=(0,c.useState)(!1);(0,c.useEffect)(()=>{u&&v?.status==="APPROVED"?q.push("/farmer/dashboard"):v?.status==="PENDING"&&x(o)},[u,v,q]);let Q=async()=>{let b=10!==y.replace(/\D/g,"").length?a("auth.errors.invalidMobile"):"";if(b)return void B(b);p((0,g.sendOtpStart)(y));try{await p((0,g.sendOtpAsync)(y)).unwrap(),p((0,g.sendOtpSuccess)()),x("otp"),R()}catch(a){p((0,g.sendOtpFailure)(a||"Failed to send OTP. Please try again."))}},R=()=>{H(30);let a=setInterval(()=>{H(b=>b<=1?(clearInterval(a),0):b-1)},1e3)},S=async b=>{if(6!==b.length)return void F(a("auth.errors.invalidOtp"));p((0,g.verifyOtpStart)());try{let a=await fetch("/api/auth/verify-otp",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({mobile:y,otp:b})}),c=await a.json();if(!a.ok){p((0,g.verifyOtpFailure)(c.error||"Invalid OTP")),F(c.error||"Invalid OTP");return}x(m),p((0,g.sendOtpSuccess)())}catch(a){p((0,g.verifyOtpFailure)("Invalid OTP. Please try again.")),F("Invalid OTP. Please try again.")}},T=async a=>{P(!0),await new Promise(a=>setTimeout(a,1e3));let b=a.slice(-4),c=["Ramesh Kumar","Suresh Patil","Amit Singh","Priya Sharma","Vijay Kumar"],d=["Maharashtra","Punjab","Karnataka","Tamil Nadu","Gujarat"],e=parseInt(b.charAt(0))%c.length,f=parseInt(b.charAt(1))%d.length,g=1960+5*parseInt(b.charAt(2)),h=parseInt(b.charAt(3))%12+1;N({name:c[e],dateOfBirth:`${g}-${h.toString().padStart(2,"0")}-15`,address:`Village/City, District, ${d[f]}`}),P(!1)},U=async()=>{console.log("ðŸ”˜ Submit button clicked"),p((0,g.verifyOtpStart)());try{console.log("ðŸ“¤ Dispatching registerAsync with:",{mobile:y,type:"farmer",name:M.name,aadharNumber:I,dateOfBirth:M.dateOfBirth,address:M.address});let a=await p((0,g.registerAsync)({mobile:y,type:"farmer",name:M.name,aadharNumber:I,dateOfBirth:M.dateOfBirth,address:M.address})).unwrap();console.log("âœ… Registration successful:",a)}catch(a){if(console.error("âŒ Registration failed:",a),console.log("Error Type:",typeof a),console.log("Error Value:",JSON.stringify(a)),String(a).includes("User already exists")||String(a).includes("already exists")){alert("User account already exists. Redirecting to login..."),p((0,g.resetAuthFlow)()),window.location.href="/login";return}p((0,g.verifyOtpFailure)(a||"Registration failed. Please try again."))}},V=()=>{w===n?x(m):w===m?(x("otp"),J(""),N({name:"",dateOfBirth:"",address:""})):(p((0,g.resetAuthFlow)()),x(l),D(""),F(""))};return(0,b.jsx)("main",{className:k.default.container,children:(0,b.jsxs)("div",{className:k.default.card,children:[w===l&&(0,b.jsxs)("div",{className:k.default.stepContent,children:[(0,b.jsxs)("div",{className:k.default.header,children:[(0,b.jsx)("div",{className:k.default.iconWrapper,children:(0,b.jsx)("span",{className:k.default.icon,role:"img","aria-label":"farmer",children:"ðŸŒ¾"})}),(0,b.jsx)("h1",{className:k.default.title,children:a("auth.farmer.title")}),(0,b.jsx)("p",{className:k.default.subtitle,children:a("auth.farmer.subtitle")})]}),(0,b.jsxs)("div",{className:k.default.form,children:[(0,b.jsx)(i.default,{label:a("auth.farmer.mobileLabel"),type:"tel",inputMode:"numeric",placeholder:a("auth.farmer.mobilePlaceholder"),value:y,onChange:a=>{z(a.target.value.replace(/\D/g,"").slice(0,10)),A&&B("")},prefix:"+91",error:A||t,required:!0,autoComplete:"tel"}),(0,b.jsx)(h.default,{onClick:Q,isLoading:r,disabled:10!==y.length,fullWidth:!0,children:a("auth.farmer.sendOtp")})]})]}),"otp"===w&&(0,b.jsxs)("div",{className:k.default.stepContent,children:[(0,b.jsx)("div",{className:"bg-blue-50 border border-blue-200 text-blue-700 px-4 py-2 rounded-md mb-4 text-sm font-mono text-center",children:"ðŸ”” DEBUG OTP: 123456"}),(0,b.jsxs)("button",{className:k.default.backButton,onClick:V,"aria-label":a("common.back"),children:["â† ",a("common.back")]}),(0,b.jsxs)("div",{className:k.default.header,children:[(0,b.jsx)("div",{className:k.default.iconWrapper,children:(0,b.jsx)("span",{className:k.default.icon,role:"img","aria-label":"verification",children:"ðŸ”"})}),(0,b.jsx)("h1",{className:k.default.title,children:a("auth.farmer.otpTitle")}),(0,b.jsxs)("p",{className:k.default.subtitle,children:[a("auth.farmer.otpSubtitle")," ",(0,b.jsxs)("strong",{children:["+91 ",s]})]})]}),(0,b.jsxs)("div",{className:k.default.form,children:[(0,b.jsx)(j.default,{length:6,onChange:D,onComplete:S,error:E||t,disabled:r}),(0,b.jsx)(h.default,{onClick:()=>S(C),isLoading:r,disabled:6!==C.length,fullWidth:!0,children:a("auth.farmer.verifyOtp")}),(0,b.jsx)("div",{className:k.default.resendWrapper,children:G>0?(0,b.jsxs)("p",{className:k.default.resendTimer,children:[a("auth.farmer.resendIn")," ",G," ",a("auth.farmer.seconds")]}):(0,b.jsx)("button",{className:k.default.resendButton,onClick:()=>{G>0||Q()},disabled:r,children:a("auth.farmer.resendOtp")})})]})]}),w===m&&(0,b.jsxs)("div",{className:k.default.stepContent,children:[(0,b.jsxs)("button",{className:k.default.backButton,onClick:V,"aria-label":a("common.back"),children:["â† ",a("common.back")]}),(0,b.jsxs)("div",{className:k.default.header,children:[(0,b.jsx)("div",{className:k.default.iconWrapper,children:(0,b.jsx)("span",{className:k.default.icon,role:"img","aria-label":"aadhar",children:"ðŸªª"})}),(0,b.jsx)("h1",{className:k.default.title,children:a("auth.farmer.title")}),(0,b.jsx)("p",{className:k.default.subtitle,children:"Enter your Aadhar for verification"})]}),(0,b.jsxs)("div",{className:k.default.form,children:[(0,b.jsx)(i.default,{label:a("auth.farmer.aadharLabel"),type:"tel",inputMode:"numeric",placeholder:a("auth.farmer.aadharPlaceholder"),value:I,onChange:a=>{let b=a.target.value.replace(/\D/g,"").slice(0,12);J(b),K&&L(""),12===b.length?T(b):N({name:"",dateOfBirth:"",address:""})},error:K,required:!0,maxLength:12}),O&&(0,b.jsxs)("div",{className:"text-center py-4",children:[(0,b.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:a("auth.farmer.extractingData")})]}),M.name&&!O&&(0,b.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 space-y-2",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-green-800 mb-3",children:a("auth.farmer.detailsExtracted")}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsxs)("span",{className:"text-gray-600",children:[a("auth.farmer.nameLabel"),":"]}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:M.name})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsxs)("span",{className:"text-gray-600",children:[a("auth.farmer.dobLabel"),":"]}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:M.dateOfBirth})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsxs)("span",{className:"text-gray-600",children:[a("auth.farmer.addressLabel"),":"]}),(0,b.jsx)("span",{className:"font-medium text-gray-900 text-right max-w-xs",children:M.address})]})]})]}),(0,b.jsx)(h.default,{onClick:()=>{let b=12!==I.replace(/\D/g,"").length?a("auth.errors.invalidAadhar"):"";b?L(b):M.name?x(n):L(a("auth.errors.aadharRequired"))},disabled:12!==I.length||!M.name||O,fullWidth:!0,children:a("common.next")})]})]}),w===n&&(0,b.jsxs)("div",{className:k.default.stepContent,children:[(0,b.jsxs)("button",{className:k.default.backButton,onClick:V,"aria-label":a("common.back"),children:["â† ",a("common.back")]}),(0,b.jsxs)("div",{className:k.default.header,children:[(0,b.jsx)("div",{className:k.default.iconWrapper,children:(0,b.jsx)("span",{className:k.default.icon,role:"img","aria-label":"check",children:"âœ“"})}),(0,b.jsx)("h1",{className:k.default.title,children:a("auth.farmer.confirmDetails")}),(0,b.jsx)("p",{className:k.default.subtitle,children:"Please review your information"})]}),(0,b.jsxs)("div",{className:k.default.form,children:[(0,b.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-5 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Mobile Number"}),(0,b.jsxs)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:["+91 ",y]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("auth.farmer.aadharLabel")}),(0,b.jsx)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:I.replace(/(\d{4})(\d{4})(\d{4})/,"$1 $2 $3")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("auth.farmer.nameLabel")}),(0,b.jsx)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:M.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("auth.farmer.dobLabel")}),(0,b.jsx)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:M.dateOfBirth})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:a("auth.farmer.addressLabel")}),(0,b.jsx)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:M.address})]})]}),(0,b.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:(0,b.jsx)("p",{className:"text-xs text-yellow-800",children:a("auth.farmer.canBrowse")})}),(0,b.jsx)(h.default,{onClick:U,isLoading:r,fullWidth:!0,children:a("common.submit")})]})]}),w===o&&(0,b.jsxs)("div",{className:k.default.stepContent,children:[(0,b.jsxs)("div",{className:k.default.header,children:[(0,b.jsx)("div",{className:`${k.default.iconWrapper} ${k.default.pendingIcon}`,children:(0,b.jsx)("span",{className:k.default.icon,role:"img","aria-label":"pending",children:"â³"})}),(0,b.jsx)("h1",{className:k.default.title,style:{color:"#d97706"},children:"Verification Pending"}),(0,b.jsx)("p",{className:k.default.subtitle,children:"Your account is currently under review by the administrator."})]}),(0,b.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4 mb-6",children:(0,b.jsx)("p",{className:"text-sm text-yellow-800 text-center",children:"Please wait for admin approval. You can try logging in later to check your status."})}),(0,b.jsx)(h.default,{onClick:()=>{p((0,g.resetAuthFlow)()),x(l),z(""),D("")},variant:"outline",fullWidth:!0,children:"Back to Login"})]})]})})}a.s(["default",()=>p])}];

//# sourceMappingURL=SEM6_SE_Farmer_Connect_src_app_%28auth%29_farmer_register_da513de5._.js.map