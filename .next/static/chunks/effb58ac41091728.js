(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56657,e=>{e.v({error:"OTPInput-module__mqNHnG__error",filled:"OTPInput-module__mqNHnG__filled",hasError:"OTPInput-module__mqNHnG__hasError",input:"OTPInput-module__mqNHnG__input",inputGroup:"OTPInput-module__mqNHnG__inputGroup",wrapper:"OTPInput-module__mqNHnG__wrapper"})},56636,53408,e=>{"use strict";var t=e.i(70650),a=e.i(33375),r=e.i(56657);function l({length:e=6,onComplete:l,onChange:s,error:i,disabled:n=!1}){let[d,u]=(0,a.useState)(Array(e).fill("")),o=(0,a.useRef)([]);(0,a.useEffect)(()=>{o.current[0]&&o.current[0].focus()},[]),(0,a.useEffect)(()=>{let t=d.join("");s&&s(t),t.length===e&&l&&l(t)},[d,e,l,s]);let c=t=>{t.preventDefault();let a=t.clipboardData.getData("text").slice(0,e);if(!/^\d+$/.test(a))return;let r=[...d];a.split("").forEach((t,a)=>{a<e&&(r[a]=t)}),u(r);let l=Math.min(a.length,e)-1;o.current[l]?.focus()};return(0,t.jsxs)("div",{className:r.default.wrapper,children:[(0,t.jsx)("div",{className:`${r.default.inputGroup} ${i?r.default.hasError:""}`,role:"group","aria-label":"OTP input",children:d.map((a,l)=>(0,t.jsx)("input",{ref:e=>o.current[l]=e,type:"text",inputMode:"numeric",pattern:"\\d*",maxLength:1,value:a,disabled:n,onChange:t=>((t,a)=>{let r=a.slice(-1);if(r&&!/^\d$/.test(r))return;let l=[...d];l[t]=r,u(l),r&&t<e-1&&o.current[t+1]?.focus()})(l,t.target.value),onKeyDown:t=>((t,a)=>{if("Backspace"===a.key){!d[t]&&t>0&&o.current[t-1]?.focus();let e=[...d];e[t]="",u(e)}else"ArrowLeft"===a.key&&t>0?o.current[t-1]?.focus():"ArrowRight"===a.key&&t<e-1&&o.current[t+1]?.focus()})(l,t),onPaste:c,className:`${r.default.input} ${a?r.default.filled:""}`,"aria-label":`Digit ${l+1} of ${e}`},l))}),i&&(0,t.jsx)("p",{className:r.default.error,role:"alert",children:i})]})}e.s(["default",()=>l],53408),e.s([],56636)},95811,e=>{e.v({button:"Button-module__Ld164q__button",fullWidth:"Button-module__Ld164q__fullWidth",hiddenText:"Button-module__Ld164q__hiddenText",lg:"Button-module__Ld164q__lg",loading:"Button-module__Ld164q__loading",md:"Button-module__Ld164q__md",outline:"Button-module__Ld164q__outline",primary:"Button-module__Ld164q__primary",secondary:"Button-module__Ld164q__secondary",sm:"Button-module__Ld164q__sm",spin:"Button-module__Ld164q__spin",spinner:"Button-module__Ld164q__spinner"})},51224,60829,e=>{"use strict";var t=e.i(70650),a=e.i(95811);function r({children:e,variant:r="primary",size:l="lg",isLoading:s=!1,disabled:i=!1,fullWidth:n=!1,type:d="button",onClick:u,ariaLabel:o,className:c="",..._}){let p=[a.default.button,a.default[r],a.default[l],n?a.default.fullWidth:"",s?a.default.loading:"",c].filter(Boolean).join(" ");return(0,t.jsxs)("button",{type:d,className:p,disabled:i||s,onClick:u,"aria-label":o,"aria-busy":s,..._,children:[s?(0,t.jsx)("span",{className:a.default.spinner,"aria-hidden":"true"}):null,(0,t.jsx)("span",{className:s?a.default.hiddenText:"",children:e})]})}e.s(["default",()=>r],60829),e.s([],51224)},80150,e=>{e.v({disabled:"Input-module__5rI_1a__disabled",error:"Input-module__5rI_1a__error",hasError:"Input-module__5rI_1a__hasError",hint:"Input-module__5rI_1a__hint",input:"Input-module__5rI_1a__input",inputWrapper:"Input-module__5rI_1a__inputWrapper",label:"Input-module__5rI_1a__label",prefix:"Input-module__5rI_1a__prefix",required:"Input-module__5rI_1a__required",suffix:"Input-module__5rI_1a__suffix",wrapper:"Input-module__5rI_1a__wrapper"})},80331,1125,e=>{"use strict";var t=e.i(70650),a=e.i(33375),r=e.i(80150);let l=(0,a.forwardRef)(function({label:e,error:l,hint:s,prefix:i,suffix:n,id:d,type:u="text",disabled:o=!1,required:c=!1,className:_="",...p},m){let h=(0,a.useId)(),f=d||`input-${h}`,g=l?`${f}-error`:void 0,b=s?`${f}-hint`:void 0;return(0,t.jsxs)("div",{className:`${r.default.wrapper} ${_}`,children:[e&&(0,t.jsxs)("label",{htmlFor:f,className:r.default.label,children:[e,c&&(0,t.jsx)("span",{className:r.default.required,"aria-hidden":"true",children:" *"})]}),(0,t.jsxs)("div",{className:`${r.default.inputWrapper} ${l?r.default.hasError:""} ${o?r.default.disabled:""}`,children:[i&&(0,t.jsx)("span",{className:r.default.prefix,"aria-hidden":"true",children:i}),(0,t.jsx)("input",{ref:m,id:f,type:u,disabled:o,required:c,"aria-invalid":l?"true":"false","aria-describedby":[g,b].filter(Boolean).join(" ")||void 0,className:r.default.input,...p}),n&&(0,t.jsx)("span",{className:r.default.suffix,children:n})]}),l&&(0,t.jsx)("p",{id:g,className:r.default.error,role:"alert",children:l}),s&&!l&&(0,t.jsx)("p",{id:b,className:r.default.hint,children:s})]})});e.s(["default",0,l],1125),e.s([],80331)},93641,e=>{e.v({arrow:"Select-module__nnj5sG__arrow",disabled:"Select-module__nnj5sG__disabled",error:"Select-module__nnj5sG__error",hasError:"Select-module__nnj5sG__hasError",hint:"Select-module__nnj5sG__hint",label:"Select-module__nnj5sG__label",required:"Select-module__nnj5sG__required",select:"Select-module__nnj5sG__select",selectWrapper:"Select-module__nnj5sG__selectWrapper",wrapper:"Select-module__nnj5sG__wrapper"})},77905,16646,e=>{"use strict";var t=e.i(70650),a=e.i(33375),r=e.i(93641);let l=(0,a.forwardRef)(function({label:e,error:l,hint:s,options:i=[],placeholder:n="Select an option",id:d,disabled:u=!1,required:o=!1,className:c="",..._},p){let m=(0,a.useId)(),h=d||`select-${m}`,f=l?`${h}-error`:void 0,g=s?`${h}-hint`:void 0;return(0,t.jsxs)("div",{className:`${r.default.wrapper} ${c}`,children:[e&&(0,t.jsxs)("label",{htmlFor:h,className:r.default.label,children:[e,o&&(0,t.jsx)("span",{className:r.default.required,"aria-hidden":"true",children:" *"})]}),(0,t.jsxs)("div",{className:`${r.default.selectWrapper} ${l?r.default.hasError:""} ${u?r.default.disabled:""}`,children:[(0,t.jsxs)("select",{ref:p,id:h,disabled:u,required:o,"aria-invalid":l?"true":"false","aria-describedby":[f,g].filter(Boolean).join(" ")||void 0,className:r.default.select,..._,children:[(0,t.jsx)("option",{value:"",disabled:!0,children:n}),i.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,t.jsx)("span",{className:r.default.arrow,"aria-hidden":"true",children:"â–¼"})]}),l&&(0,t.jsx)("p",{id:f,className:r.default.error,role:"alert",children:l}),s&&!l&&(0,t.jsx)("p",{id:g,className:r.default.hint,children:s})]})});e.s(["default",0,l],16646),e.s([],77905)},65058,e=>{e.v({active:"page-module__1-nkhW__active",backButton:"page-module__1-nkhW__backButton",card:"page-module__1-nkhW__card",completed:"page-module__1-nkhW__completed",container:"page-module__1-nkhW__container",form:"page-module__1-nkhW__form",header:"page-module__1-nkhW__header",icon:"page-module__1-nkhW__icon",iconWrapper:"page-module__1-nkhW__iconWrapper",progress:"page-module__1-nkhW__progress",progressDot:"page-module__1-nkhW__progressDot",progressItem:"page-module__1-nkhW__progressItem",progressLabel:"page-module__1-nkhW__progressLabel",progressLine:"page-module__1-nkhW__progressLine",progressStep:"page-module__1-nkhW__progressStep",pulse:"page-module__1-nkhW__pulse",resendButton:"page-module__1-nkhW__resendButton",resendTimer:"page-module__1-nkhW__resendTimer",resendWrapper:"page-module__1-nkhW__resendWrapper",stepContent:"page-module__1-nkhW__stepContent",subtitle:"page-module__1-nkhW__subtitle",successIcon:"page-module__1-nkhW__successIcon",summaryCard:"page-module__1-nkhW__summaryCard",summaryRow:"page-module__1-nkhW__summaryRow",title:"page-module__1-nkhW__title"})},87145,e=>{"use strict";var t=e.i(70650),a=e.i(33375);e.i(64142);var r=e.i(73178),l=e.i(31169),s=e.i(86383),i=e.i(90759);e.i(51224);var n=e.i(60829);e.i(80331);var d=e.i(1125);e.i(77905);var u=e.i(16646);e.i(56636);var o=e.i(53408),c=e.i(65058);let _="mobile",p="business",m="category",h="pending",f=[{value:"retailer",label:"Retailer"},{value:"wholesaler",label:"Wholesaler"},{value:"cooperative",label:"Cooperative"},{value:"institution",label:"Institution"},{value:"processor",label:"Food Processor"}],g=[{id:"vegetables",label:"Vegetables",icon:"ðŸ¥¦"},{id:"fruits",label:"Fruits",icon:"ðŸŽ"},{id:"grains",label:"Grains & Pulses",icon:"ðŸŒ¾"},{id:"spices",label:"Spices",icon:"ðŸŒ¶ï¸"},{id:"flowers",label:"Flowers",icon:"ðŸŒ¸"},{id:"dairy",label:"Dairy",icon:"ðŸ¥›"}];function b(){let{t:e}=(0,r.useTranslation)(),b=(0,l.useDispatch)(),x=(0,s.useRouter)(),{isLoading:j,mobileNumber:v,isAuthenticated:N,user:y,error:k}=(0,l.useSelector)(e=>e.auth),[I,C]=(0,a.useState)(_),[W,w]=(0,a.useState)(""),[S,q]=(0,a.useState)(""),[B,O]=(0,a.useState)({businessName:"",taxId:"",category:"",contactName:"",interestedCategories:[],email:""}),[T,$]=(0,a.useState)({}),[P,G]=(0,a.useState)(""),[L,E]=(0,a.useState)(""),[A,R]=(0,a.useState)(0);(0,a.useEffect)(()=>{N&&y?.status==="APPROVED"?x.push("/buyer/dashboard"):y?.status==="PENDING"&&C(h)},[N,y,x]);let D=(e,t)=>{O(a=>({...a,[e]:t})),T[e]&&$(t=>({...t,[e]:""}))},F=async()=>{if(10!==W.length)return void q("Enter valid 10-digit mobile number");b((0,i.sendOtpStart)(W));try{await b((0,i.sendOtpAsync)(W)).unwrap(),b((0,i.sendOtpSuccess)()),C("otp"),H()}catch(e){b((0,i.sendOtpFailure)(e||"Failed to send OTP")),q(e||"Failed to send OTP")}},U=async()=>{if(0===B.interestedCategories.length)return void $({...T,interestedCategories:"Please select at least one category"});b((0,i.verifyOtpStart)());try{await b((0,i.registerAsync)({mobile:W,type:"buyer",businessName:B.businessName,taxId:B.taxId,businessCategory:B.category,contactName:B.contactName})).unwrap()}catch(e){if(console.error("âŒ Registration failed:",e),String(e).includes("User already exists")||String(e).includes("already exists")){alert("User account already exists. Redirecting to login..."),b((0,i.resetAuthFlow)()),window.location.href="/login";return}b((0,i.verifyOtpFailure)(e||"Registration failed"))}},H=()=>{R(30);let e=setInterval(()=>{R(t=>t<=1?(clearInterval(e),0):t-1)},1e3)},M=async e=>{if(6===e.length){b((0,i.verifyOtpStart)());try{(await b((0,i.verifyOtpAsync)({mobile:W,otp:e,userType:"buyer"})).unwrap()).isNewUser&&(b((0,i.sendOtpSuccess)()),C(p))}catch(e){E(e||"Invalid OTP"),b((0,i.verifyOtpFailure)(e))}}},K=()=>{"otp"===I?(C(_),b((0,i.resetAuthFlow)())):I===p?C("otp"):I===m?C(p):I===h&&(C(_),b((0,i.resetAuthFlow)()))};return(0,t.jsx)("main",{className:c.default.container,children:(0,t.jsxs)("div",{className:c.default.card,children:[I===_&&(0,t.jsxs)("div",{className:c.default.stepContent,children:[(0,t.jsxs)("div",{className:c.default.header,children:[(0,t.jsx)("div",{className:c.default.iconWrapper,children:(0,t.jsx)("span",{className:c.default.icon,role:"img","aria-label":"buyer",children:"ðŸ›’"})}),(0,t.jsx)("h1",{className:c.default.title,children:e("auth.buyer.title")}),(0,t.jsx)("p",{className:c.default.subtitle,children:"Login or Register"})]}),(0,t.jsxs)("div",{className:c.default.form,children:[(0,t.jsx)(d.default,{label:"Mobile Number",type:"tel",inputMode:"numeric",placeholder:"Enter 10-digit mobile",value:W,onChange:e=>{w(e.target.value.replace(/\D/g,"").slice(0,10)),q("")},prefix:"+91",error:S||k,required:!0}),(0,t.jsx)(n.default,{onClick:F,isLoading:j,fullWidth:!0,children:"Continue"})]})]}),"otp"===I&&(0,t.jsxs)("div",{className:c.default.stepContent,children:[(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 text-blue-700 px-4 py-2 rounded-md mb-4 text-sm font-mono text-center",children:"ðŸ”” DEBUG OTP: 123456"}),(0,t.jsx)("button",{className:c.default.backButton,onClick:K,children:"â† Back"}),(0,t.jsxs)("div",{className:c.default.header,children:[(0,t.jsx)("div",{className:c.default.iconWrapper,children:(0,t.jsx)("span",{className:c.default.icon,role:"img","aria-label":"verify",children:"ðŸ”"})}),(0,t.jsx)("h1",{className:c.default.title,children:e("auth.farmer.otpTitle")}),(0,t.jsxs)("p",{className:c.default.subtitle,children:["Enter the 6-digit code sent to ",(0,t.jsxs)("strong",{children:["+91 ",W]})]})]}),(0,t.jsxs)("div",{className:c.default.form,children:[(0,t.jsx)(o.default,{length:6,onChange:G,onComplete:M,disabled:j,error:L||k}),(0,t.jsx)(n.default,{onClick:()=>M(P),isLoading:j,disabled:6!==P.length,fullWidth:!0,children:e("auth.farmer.verifyOtp")}),(0,t.jsx)("div",{className:c.default.resendWrapper,children:A>0?(0,t.jsxs)("p",{className:c.default.resendTimer,children:["Resend in ",A,"s"]}):(0,t.jsx)("button",{className:c.default.resendButton,onClick:()=>{b((0,i.sendOtpAsync)(W)),H()},children:"Resend OTP"})})]})]}),I===p&&(0,t.jsxs)("div",{className:c.default.stepContent,children:[(0,t.jsx)("button",{className:c.default.backButton,onClick:K,children:"â† Back"}),(0,t.jsxs)("div",{className:c.default.header,children:[(0,t.jsx)("h1",{className:c.default.title,children:"Business Details"}),(0,t.jsx)("p",{className:c.default.subtitle,children:"Complete your profile to continue"})]}),(0,t.jsxs)("div",{className:c.default.form,children:[(0,t.jsx)(d.default,{label:e("auth.buyer.businessName"),placeholder:"Enter your business name",value:B.businessName,onChange:e=>D("businessName",e.target.value),error:T.businessName,required:!0}),(0,t.jsx)(d.default,{label:e("auth.buyer.taxId"),placeholder:"e.g., 22AAAAA0000A1Z5",value:B.taxId,onChange:e=>D("taxId",e.target.value.toUpperCase()),error:T.taxId,hint:"GST Number",required:!0}),(0,t.jsx)(u.default,{label:e("auth.buyer.category"),placeholder:"Select business type",options:f,value:B.category,onChange:e=>D("category",e.target.value),error:T.category,required:!0}),(0,t.jsx)(d.default,{label:"Contact Person",placeholder:"Enter contact person name",value:B.contactName,onChange:e=>D("contactName",e.target.value),error:T.contactName,required:!0}),(0,t.jsx)(n.default,{onClick:()=>{let e;e={},B.businessName.trim()||(e.businessName="Business name is required"),B.taxId.trim()||(e.taxId="Tax ID / GST Number is required"),B.category||(e.category="Please select a business category"),B.contactName.trim()||(e.contactName="Contact person name is required"),$(e),0===Object.keys(e).length&&C(m)},fullWidth:!0,children:"Continue to Interests"})]})]}),I===m&&(0,t.jsxs)("div",{className:c.default.stepContent,children:[(0,t.jsx)("button",{className:c.default.backButton,onClick:K,children:"â† Back"}),(0,t.jsxs)("div",{className:c.default.header,children:[(0,t.jsx)("h1",{className:c.default.title,children:"What do you buy?"}),(0,t.jsx)("p",{className:c.default.subtitle,children:"Select categories you are interested in"})]}),(0,t.jsxs)("div",{className:c.default.form,children:[(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-6",children:g.map(e=>(0,t.jsxs)("button",{className:`p-4 rounded-xl border flex flex-col items-center gap-2 transition-all ${B.interestedCategories.includes(e.id)?"border-green-600 bg-green-50 text-green-700 font-medium ring-1 ring-green-600":"border-gray-200 hover:border-green-400 hover:bg-gray-50 text-gray-600"}`,onClick:()=>{var t;return t=e.id,void(O(e=>{let a=e.interestedCategories||[];return a.includes(t)?{...e,interestedCategories:a.filter(e=>e!==t)}:{...e,interestedCategories:[...a,t]}}),T.interestedCategories&&$(e=>({...e,interestedCategories:""})))},children:[(0,t.jsx)("span",{className:"text-2xl",children:e.icon}),(0,t.jsx)("span",{className:"text-sm",children:e.label})]},e.id))}),T.interestedCategories&&(0,t.jsx)("p",{className:"text-red-500 text-sm text-center mb-4",children:T.interestedCategories}),(0,t.jsx)(n.default,{onClick:U,isLoading:j,fullWidth:!0,children:"Complete Registration"})]})]}),I===h&&(0,t.jsxs)("div",{className:c.default.stepContent,children:[(0,t.jsxs)("div",{className:c.default.header,children:[(0,t.jsx)("div",{className:`${c.default.iconWrapper} ${c.default.pendingIcon}`,children:(0,t.jsx)("span",{className:c.default.icon,role:"img","aria-label":"pending",children:"â³"})}),(0,t.jsx)("h1",{className:c.default.title,style:{color:"#d97706"},children:"Verification Pending"}),(0,t.jsx)("p",{className:c.default.subtitle,children:"Your account is currently under review by the administrator."})]}),(0,t.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4 mb-6",children:(0,t.jsx)("p",{className:"text-sm text-yellow-800 text-center",children:"Please wait for admin approval. You can try logging in later to check your status."})}),(0,t.jsx)(n.default,{onClick:()=>{b((0,i.resetAuthFlow)()),C(_),w(""),G("")},variant:"outline",fullWidth:!0,children:"Back to Login"})]})]})})}e.s(["default",()=>b])}]);