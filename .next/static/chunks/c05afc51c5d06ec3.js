(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95811,e=>{e.v({button:"Button-module__Ld164q__button",fullWidth:"Button-module__Ld164q__fullWidth",hiddenText:"Button-module__Ld164q__hiddenText",lg:"Button-module__Ld164q__lg",loading:"Button-module__Ld164q__loading",md:"Button-module__Ld164q__md",outline:"Button-module__Ld164q__outline",primary:"Button-module__Ld164q__primary",secondary:"Button-module__Ld164q__secondary",sm:"Button-module__Ld164q__sm",spin:"Button-module__Ld164q__spin",spinner:"Button-module__Ld164q__spinner"})},51224,60829,e=>{"use strict";var a=e.i(70650),t=e.i(95811);function r({children:e,variant:r="primary",size:l="lg",isLoading:s=!1,disabled:i=!1,fullWidth:d=!1,type:n="button",onClick:u,ariaLabel:o,className:c="",...m}){let p=[t.default.button,t.default[r],t.default[l],d?t.default.fullWidth:"",s?t.default.loading:"",c].filter(Boolean).join(" ");return(0,a.jsxs)("button",{type:n,className:p,disabled:i||s,onClick:u,"aria-label":o,"aria-busy":s,...m,children:[s?(0,a.jsx)("span",{className:t.default.spinner,"aria-hidden":"true"}):null,(0,a.jsx)("span",{className:s?t.default.hiddenText:"",children:e})]})}e.s(["default",()=>r],60829),e.s([],51224)},80150,e=>{e.v({disabled:"Input-module__5rI_1a__disabled",error:"Input-module__5rI_1a__error",hasError:"Input-module__5rI_1a__hasError",hint:"Input-module__5rI_1a__hint",input:"Input-module__5rI_1a__input",inputWrapper:"Input-module__5rI_1a__inputWrapper",label:"Input-module__5rI_1a__label",prefix:"Input-module__5rI_1a__prefix",required:"Input-module__5rI_1a__required",suffix:"Input-module__5rI_1a__suffix",wrapper:"Input-module__5rI_1a__wrapper"})},80331,1125,e=>{"use strict";var a=e.i(70650),t=e.i(33375),r=e.i(80150);let l=(0,t.forwardRef)(function({label:e,error:l,hint:s,prefix:i,suffix:d,id:n,type:u="text",disabled:o=!1,required:c=!1,className:m="",...p},h){let f=(0,t.useId)(),_=n||`input-${f}`,x=l?`${_}-error`:void 0,g=s?`${_}-hint`:void 0;return(0,a.jsxs)("div",{className:`${r.default.wrapper} ${m}`,children:[e&&(0,a.jsxs)("label",{htmlFor:_,className:r.default.label,children:[e,c&&(0,a.jsx)("span",{className:r.default.required,"aria-hidden":"true",children:" *"})]}),(0,a.jsxs)("div",{className:`${r.default.inputWrapper} ${l?r.default.hasError:""} ${o?r.default.disabled:""}`,children:[i&&(0,a.jsx)("span",{className:r.default.prefix,"aria-hidden":"true",children:i}),(0,a.jsx)("input",{ref:h,id:_,type:u,disabled:o,required:c,"aria-invalid":l?"true":"false","aria-describedby":[x,g].filter(Boolean).join(" ")||void 0,className:r.default.input,...p}),d&&(0,a.jsx)("span",{className:r.default.suffix,children:d})]}),l&&(0,a.jsx)("p",{id:x,className:r.default.error,role:"alert",children:l}),s&&!l&&(0,a.jsx)("p",{id:g,className:r.default.hint,children:s})]})});e.s(["default",0,l],1125),e.s([],80331)},56657,e=>{e.v({error:"OTPInput-module__mqNHnG__error",filled:"OTPInput-module__mqNHnG__filled",hasError:"OTPInput-module__mqNHnG__hasError",input:"OTPInput-module__mqNHnG__input",inputGroup:"OTPInput-module__mqNHnG__inputGroup",wrapper:"OTPInput-module__mqNHnG__wrapper"})},56636,53408,e=>{"use strict";var a=e.i(70650),t=e.i(33375),r=e.i(56657);function l({length:e=6,onComplete:l,onChange:s,error:i,disabled:d=!1}){let[n,u]=(0,t.useState)(Array(e).fill("")),o=(0,t.useRef)([]);(0,t.useEffect)(()=>{o.current[0]&&o.current[0].focus()},[]),(0,t.useEffect)(()=>{let a=n.join("");s&&s(a),a.length===e&&l&&l(a)},[n,e,l,s]);let c=a=>{a.preventDefault();let t=a.clipboardData.getData("text").slice(0,e);if(!/^\d+$/.test(t))return;let r=[...n];t.split("").forEach((a,t)=>{t<e&&(r[t]=a)}),u(r);let l=Math.min(t.length,e)-1;o.current[l]?.focus()};return(0,a.jsxs)("div",{className:r.default.wrapper,children:[(0,a.jsx)("div",{className:`${r.default.inputGroup} ${i?r.default.hasError:""}`,role:"group","aria-label":"OTP input",children:n.map((t,l)=>(0,a.jsx)("input",{ref:e=>o.current[l]=e,type:"text",inputMode:"numeric",pattern:"\\d*",maxLength:1,value:t,disabled:d,onChange:a=>((a,t)=>{let r=t.slice(-1);if(r&&!/^\d$/.test(r))return;let l=[...n];l[a]=r,u(l),r&&a<e-1&&o.current[a+1]?.focus()})(l,a.target.value),onKeyDown:a=>((a,t)=>{if("Backspace"===t.key){!n[a]&&a>0&&o.current[a-1]?.focus();let e=[...n];e[a]="",u(e)}else"ArrowLeft"===t.key&&a>0?o.current[a-1]?.focus():"ArrowRight"===t.key&&a<e-1&&o.current[a+1]?.focus()})(l,a),onPaste:c,className:`${r.default.input} ${t?r.default.filled:""}`,"aria-label":`Digit ${l+1} of ${e}`},l))}),i&&(0,a.jsx)("p",{className:r.default.error,role:"alert",children:i})]})}e.s(["default",()=>l],53408),e.s([],56636)},44603,e=>{e.v({active:"page-module__xGAElW__active",backButton:"page-module__xGAElW__backButton",card:"page-module__xGAElW__card",completed:"page-module__xGAElW__completed",container:"page-module__xGAElW__container",form:"page-module__xGAElW__form",header:"page-module__xGAElW__header",icon:"page-module__xGAElW__icon",iconWrapper:"page-module__xGAElW__iconWrapper",progress:"page-module__xGAElW__progress",progressDot:"page-module__xGAElW__progressDot",progressLabel:"page-module__xGAElW__progressLabel",progressLine:"page-module__xGAElW__progressLine",progressStep:"page-module__xGAElW__progressStep",pulse:"page-module__xGAElW__pulse",resendButton:"page-module__xGAElW__resendButton",resendTimer:"page-module__xGAElW__resendTimer",resendWrapper:"page-module__xGAElW__resendWrapper",stepContent:"page-module__xGAElW__stepContent",subtitle:"page-module__xGAElW__subtitle",successIcon:"page-module__xGAElW__successIcon",title:"page-module__xGAElW__title"})},94984,e=>{"use strict";var a=e.i(70650),t=e.i(33375);e.i(64142);var r=e.i(73178),l=e.i(31169),s=e.i(86383),i=e.i(90759);e.i(51224);var d=e.i(60829);e.i(80331);var n=e.i(1125);e.i(56636);var u=e.i(53408),o=e.i(44603);let c="mobile",m="aadhar",p="confirm",h="pending";function f(){let{t:e}=(0,r.useTranslation)(),f=(0,l.useDispatch)(),_=(0,s.useRouter)(),{isLoading:x,mobileNumber:g,error:b,isAuthenticated:j,user:N}=(0,l.useSelector)(e=>e.auth),[y,v]=(0,t.useState)(c),[w,I]=(0,t.useState)(""),[O,W]=(0,t.useState)(""),[A,E]=(0,t.useState)(""),[B,k]=(0,t.useState)(""),[G,P]=(0,t.useState)(0),[L,S]=(0,t.useState)(""),[T,C]=(0,t.useState)(""),[q,$]=(0,t.useState)({name:"",dateOfBirth:"",address:""}),[D,R]=(0,t.useState)(!1);(0,t.useEffect)(()=>{j&&N?.status==="APPROVED"?_.push("/farmer/dashboard"):N?.status==="PENDING"&&v(h)},[j,N,_]);let F=async()=>{let a=10!==w.replace(/\D/g,"").length?e("auth.errors.invalidMobile"):"";if(a)return void W(a);f((0,i.sendOtpStart)(w));try{await f((0,i.sendOtpAsync)(w)).unwrap(),f((0,i.sendOtpSuccess)()),v("otp"),M()}catch(e){f((0,i.sendOtpFailure)(e||"Failed to send OTP. Please try again."))}},M=()=>{P(30);let e=setInterval(()=>{P(a=>a<=1?(clearInterval(e),0):a-1)},1e3)},H=async a=>{if(6!==a.length)return void k(e("auth.errors.invalidOtp"));f((0,i.verifyOtpStart)());try{let e=await fetch("/api/auth/verify-otp",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({mobile:w,otp:a})}),t=await e.json();if(!e.ok){f((0,i.verifyOtpFailure)(t.error||"Invalid OTP")),k(t.error||"Invalid OTP");return}v(m),f((0,i.sendOtpSuccess)())}catch(e){f((0,i.verifyOtpFailure)("Invalid OTP. Please try again.")),k("Invalid OTP. Please try again.")}},K=async e=>{R(!0),await new Promise(e=>setTimeout(e,1e3));let a=e.slice(-4),t=["Ramesh Kumar","Suresh Patil","Amit Singh","Priya Sharma","Vijay Kumar"],r=["Maharashtra","Punjab","Karnataka","Tamil Nadu","Gujarat"],l=parseInt(a.charAt(0))%t.length,s=parseInt(a.charAt(1))%r.length,i=1960+5*parseInt(a.charAt(2)),d=parseInt(a.charAt(3))%12+1;$({name:t[l],dateOfBirth:`${i}-${d.toString().padStart(2,"0")}-15`,address:`Village/City, District, ${r[s]}`}),R(!1)},U=async()=>{console.log("ðŸ”˜ Submit button clicked"),f((0,i.verifyOtpStart)());try{console.log("ðŸ“¤ Dispatching registerAsync with:",{mobile:w,type:"farmer",name:q.name,aadharNumber:L,dateOfBirth:q.dateOfBirth,address:q.address});let e=await f((0,i.registerAsync)({mobile:w,type:"farmer",name:q.name,aadharNumber:L,dateOfBirth:q.dateOfBirth,address:q.address})).unwrap();console.log("âœ… Registration successful:",e)}catch(e){if(console.error("âŒ Registration failed:",e),console.log("Error Type:",typeof e),console.log("Error Value:",JSON.stringify(e)),String(e).includes("User already exists")||String(e).includes("already exists")){alert("User account already exists. Redirecting to login..."),f((0,i.resetAuthFlow)()),window.location.href="/login";return}f((0,i.verifyOtpFailure)(e||"Registration failed. Please try again."))}},V=()=>{y===p?v(m):y===m?(v("otp"),S(""),$({name:"",dateOfBirth:"",address:""})):(f((0,i.resetAuthFlow)()),v(c),E(""),k(""))};return(0,a.jsx)("main",{className:o.default.container,children:(0,a.jsxs)("div",{className:o.default.card,children:[y===c&&(0,a.jsxs)("div",{className:o.default.stepContent,children:[(0,a.jsxs)("div",{className:o.default.header,children:[(0,a.jsx)("div",{className:o.default.iconWrapper,children:(0,a.jsx)("span",{className:o.default.icon,role:"img","aria-label":"farmer",children:"ðŸŒ¾"})}),(0,a.jsx)("h1",{className:o.default.title,children:e("auth.farmer.title")}),(0,a.jsx)("p",{className:o.default.subtitle,children:e("auth.farmer.subtitle")})]}),(0,a.jsxs)("div",{className:o.default.form,children:[(0,a.jsx)(n.default,{label:e("auth.farmer.mobileLabel"),type:"tel",inputMode:"numeric",placeholder:e("auth.farmer.mobilePlaceholder"),value:w,onChange:e=>{I(e.target.value.replace(/\D/g,"").slice(0,10)),O&&W("")},prefix:"+91",error:O||b,required:!0,autoComplete:"tel"}),(0,a.jsx)(d.default,{onClick:F,isLoading:x,disabled:10!==w.length,fullWidth:!0,children:e("auth.farmer.sendOtp")})]})]}),"otp"===y&&(0,a.jsxs)("div",{className:o.default.stepContent,children:[(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 text-blue-700 px-4 py-2 rounded-md mb-4 text-sm font-mono text-center",children:"ðŸ”” DEBUG OTP: 123456"}),(0,a.jsxs)("button",{className:o.default.backButton,onClick:V,"aria-label":e("common.back"),children:["â† ",e("common.back")]}),(0,a.jsxs)("div",{className:o.default.header,children:[(0,a.jsx)("div",{className:o.default.iconWrapper,children:(0,a.jsx)("span",{className:o.default.icon,role:"img","aria-label":"verification",children:"ðŸ”"})}),(0,a.jsx)("h1",{className:o.default.title,children:e("auth.farmer.otpTitle")}),(0,a.jsxs)("p",{className:o.default.subtitle,children:[e("auth.farmer.otpSubtitle")," ",(0,a.jsxs)("strong",{children:["+91 ",g]})]})]}),(0,a.jsxs)("div",{className:o.default.form,children:[(0,a.jsx)(u.default,{length:6,onChange:E,onComplete:H,error:B||b,disabled:x}),(0,a.jsx)(d.default,{onClick:()=>H(A),isLoading:x,disabled:6!==A.length,fullWidth:!0,children:e("auth.farmer.verifyOtp")}),(0,a.jsx)("div",{className:o.default.resendWrapper,children:G>0?(0,a.jsxs)("p",{className:o.default.resendTimer,children:[e("auth.farmer.resendIn")," ",G," ",e("auth.farmer.seconds")]}):(0,a.jsx)("button",{className:o.default.resendButton,onClick:()=>{G>0||F()},disabled:x,children:e("auth.farmer.resendOtp")})})]})]}),y===m&&(0,a.jsxs)("div",{className:o.default.stepContent,children:[(0,a.jsxs)("button",{className:o.default.backButton,onClick:V,"aria-label":e("common.back"),children:["â† ",e("common.back")]}),(0,a.jsxs)("div",{className:o.default.header,children:[(0,a.jsx)("div",{className:o.default.iconWrapper,children:(0,a.jsx)("span",{className:o.default.icon,role:"img","aria-label":"aadhar",children:"ðŸªª"})}),(0,a.jsx)("h1",{className:o.default.title,children:e("auth.farmer.title")}),(0,a.jsx)("p",{className:o.default.subtitle,children:"Enter your Aadhar for verification"})]}),(0,a.jsxs)("div",{className:o.default.form,children:[(0,a.jsx)(n.default,{label:e("auth.farmer.aadharLabel"),type:"tel",inputMode:"numeric",placeholder:e("auth.farmer.aadharPlaceholder"),value:L,onChange:e=>{let a=e.target.value.replace(/\D/g,"").slice(0,12);S(a),T&&C(""),12===a.length?K(a):$({name:"",dateOfBirth:"",address:""})},error:T,required:!0,maxLength:12}),D&&(0,a.jsxs)("div",{className:"text-center py-4",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:e("auth.farmer.extractingData")})]}),q.name&&!D&&(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 space-y-2",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-green-800 mb-3",children:e("auth.farmer.detailsExtracted")}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600",children:[e("auth.farmer.nameLabel"),":"]}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:q.name})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600",children:[e("auth.farmer.dobLabel"),":"]}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:q.dateOfBirth})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-gray-600",children:[e("auth.farmer.addressLabel"),":"]}),(0,a.jsx)("span",{className:"font-medium text-gray-900 text-right max-w-xs",children:q.address})]})]})]}),(0,a.jsx)(d.default,{onClick:()=>{let a=12!==L.replace(/\D/g,"").length?e("auth.errors.invalidAadhar"):"";a?C(a):q.name?v(p):C(e("auth.errors.aadharRequired"))},disabled:12!==L.length||!q.name||D,fullWidth:!0,children:e("common.next")})]})]}),y===p&&(0,a.jsxs)("div",{className:o.default.stepContent,children:[(0,a.jsxs)("button",{className:o.default.backButton,onClick:V,"aria-label":e("common.back"),children:["â† ",e("common.back")]}),(0,a.jsxs)("div",{className:o.default.header,children:[(0,a.jsx)("div",{className:o.default.iconWrapper,children:(0,a.jsx)("span",{className:o.default.icon,role:"img","aria-label":"check",children:"âœ“"})}),(0,a.jsx)("h1",{className:o.default.title,children:e("auth.farmer.confirmDetails")}),(0,a.jsx)("p",{className:o.default.subtitle,children:"Please review your information"})]}),(0,a.jsxs)("div",{className:o.default.form,children:[(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-5 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Mobile Number"}),(0,a.jsxs)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:["+91 ",w]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:e("auth.farmer.aadharLabel")}),(0,a.jsx)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:L.replace(/(\d{4})(\d{4})(\d{4})/,"$1 $2 $3")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:e("auth.farmer.nameLabel")}),(0,a.jsx)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:q.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:e("auth.farmer.dobLabel")}),(0,a.jsx)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:q.dateOfBirth})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:e("auth.farmer.addressLabel")}),(0,a.jsx)("p",{className:"text-base font-semibold text-gray-900 mt-1",children:q.address})]})]}),(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:(0,a.jsx)("p",{className:"text-xs text-yellow-800",children:e("auth.farmer.canBrowse")})}),(0,a.jsx)(d.default,{onClick:U,isLoading:x,fullWidth:!0,children:e("common.submit")})]})]}),y===h&&(0,a.jsxs)("div",{className:o.default.stepContent,children:[(0,a.jsxs)("div",{className:o.default.header,children:[(0,a.jsx)("div",{className:`${o.default.iconWrapper} ${o.default.pendingIcon}`,children:(0,a.jsx)("span",{className:o.default.icon,role:"img","aria-label":"pending",children:"â³"})}),(0,a.jsx)("h1",{className:o.default.title,style:{color:"#d97706"},children:"Verification Pending"}),(0,a.jsx)("p",{className:o.default.subtitle,children:"Your account is currently under review by the administrator."})]}),(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4 mb-6",children:(0,a.jsx)("p",{className:"text-sm text-yellow-800 text-center",children:"Please wait for admin approval. You can try logging in later to check your status."})}),(0,a.jsx)(d.default,{onClick:()=>{f((0,i.resetAuthFlow)()),v(c),I(""),E("")},variant:"outline",fullWidth:!0,children:"Back to Login"})]})]})})}e.s(["default",()=>f])}]);